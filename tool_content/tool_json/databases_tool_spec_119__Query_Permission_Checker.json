{
  "tool_name": "Query Permission Checker",
  "tool_description": "Analyzes SQL queries and validates user permissions to execute specific database operations against security policies.",
  "parameters": {
    "user_id": {
      "type": "string",
      "required": true,
      "description": "User attempting to execute the query"
    },
    "sql_query": {
      "type": "string",
      "required": true,
      "description": "SQL query to analyze and validate"
    },
    "query_type": {
      "type": "string",
      "required": false,
      "description": "Query classification: select, insert, update, delete, ddl, dml, stored_procedure",
      "default": "auto_detect"
    },
    "database_name": {
      "type": "string",
      "required": false,
      "description": "Target database for the query",
      "default": "current"
    },
    "validate_syntax": {
      "type": "boolean",
      "required": false,
      "description": "Whether to validate SQL syntax",
      "default": true
    }
  },
  "error_messages": [
    "User not found: Specified user_id does not exist",
    "Invalid SQL syntax: Query contains syntax errors",
    "Invalid query type: Use one of [select, insert, update, delete, ddl, dml, stored_procedure, auto_detect]",
    "Database not found: Specified database does not exist",
    "Permission denied: User lacks permission to execute this query type",
    "Resource access denied: User cannot access one or more resources referenced in query",
    "Policy violation: Query violates active security policies"
  ],
  "usage": "Provide user_id and sql_query for validation. Optionally specify query_type, database_name, and validate_syntax. The tool analyzes the query and returns permission validation results.",
  "output_details": {
    "permission_granted": {
      "type": "boolean",
      "description": "Whether user has permission to execute the query"
    },
    "detected_query_type": {
      "type": "string",
      "description": "Auto-detected or confirmed query type"
    },
    "affected_resources": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "Database resources referenced in the query"
    },
    "permission_issues": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "List of permission issues found"
    },
    "risk_assessment": {
      "type": "string",
      "description": "Risk level of the query execution"
    }
  }
}