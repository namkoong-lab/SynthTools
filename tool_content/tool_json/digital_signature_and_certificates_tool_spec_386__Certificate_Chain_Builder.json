{
  "tool_name": "Certificate Chain Builder",
  "tool_description": "Constructs a complete certificate chain from a target certificate up to a trusted root by searching through provided certificate stores and attempting to fetch missing intermediate certificates.",
  "parameters": {
    "target_certificate": {
      "type": "string",
      "required": true,
      "description": "The end-entity certificate for which to build a chain"
    },
    "intermediate_certificates": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "required": false,
      "description": "Array of intermediate certificates to consider for chain building",
      "default": "None"
    },
    "trusted_roots": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "required": true,
      "description": "Array of trusted root certificates"
    },
    "fetch_missing": {
      "type": "boolean",
      "required": false,
      "description": "Whether to attempt fetching missing intermediate certificates via AIA extension",
      "default": true
    },
    "max_chain_length": {
      "type": "integer",
      "required": false,
      "description": "Maximum allowed certificate chain length (1-20)",
      "default": 10
    }
  },
  "error_messages": [
    "Invalid target certificate: Target certificate is malformed or cannot be parsed.",
    "Chain building failed: Unable to construct a valid chain to any trusted root.",
    "Maximum chain length exceeded: Chain length exceeds max_chain_length parameter.",
    "Invalid trusted roots: One or more trusted root certificates are invalid.",
    "Network error during fetch: Failed to retrieve intermediate certificates from AIA URLs."
  ],
  "usage": "Provide target_certificate and trusted_roots array. Optionally include intermediate_certificates and configure fetch_missing and max_chain_length. Returns ordered certificate chain from target to root.",
  "output_details": {
    "chain": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "Ordered certificate chain from end-entity to root"
    },
    "chain_length": {
      "type": "integer",
      "description": "Number of certificates in the chain"
    },
    "root_found": {
      "type": "boolean",
      "description": "Whether a trusted root was found"
    },
    "missing_certificates": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "List of certificate subjects that could not be found"
    }
  }
}