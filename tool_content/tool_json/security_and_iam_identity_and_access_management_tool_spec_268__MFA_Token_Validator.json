{
  "tool_name": "MFA Token Validator",
  "tool_description": "Validates MFA tokens against stored secrets and handles token replay prevention and timing windows.",
  "parameters": {
    "user_id": {
      "type": "string",
      "required": true,
      "description": "Unique identifier for the user"
    },
    "token": {
      "type": "string",
      "required": true,
      "description": "MFA token to validate"
    },
    "mfa_method": {
      "type": "string",
      "required": true,
      "description": "MFA method used: totp, sms, email, push, backup_codes"
    },
    "time_window": {
      "type": "integer",
      "required": false,
      "default": 30,
      "description": "Time window in seconds for TOTP validation (15-300)"
    },
    "allow_replay": {
      "type": "boolean",
      "required": false,
      "default": false,
      "description": "Whether to allow token replay within time window"
    }
  },
  "error_messages": [
    "Invalid MFA method: Use one of [totp, sms, email, push, backup_codes]",
    "Invalid time_window: Must be between 15 and 300 seconds",
    "Empty token: Token cannot be empty or null",
    "User not found: The specified user_id does not exist",
    "Token expired: The provided token has expired",
    "Token already used: Token replay detected and not allowed"
  ],
  "usage": "Provide user_id, token, and mfa_method. Optionally set time_window for TOTP and allow_replay for token reuse policy.",
  "output_details": {
    "is_valid": {
      "type": "boolean",
      "description": "Whether the token is valid"
    },
    "validation_timestamp": {
      "type": "string",
      "description": "Timestamp of validation in ISO 8601 format"
    },
    "remaining_attempts": {
      "type": "integer",
      "description": "Number of remaining validation attempts before lockout"
    },
    "method_verified": {
      "type": "string",
      "description": "The MFA method that was successfully verified"
    }
  }
}