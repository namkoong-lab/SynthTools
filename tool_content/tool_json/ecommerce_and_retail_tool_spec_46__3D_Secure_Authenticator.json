{
  "tool_name": "3D Secure Authenticator",
  "tool_description": "Initiates and processes 3D Secure authentication for enhanced security on online card transactions, supporting both 3DS1 and 3DS2 protocols.",
  "parameters": {
    "card_number": {
      "type": "string",
      "required": true,
      "description": "Card number for 3DS authentication"
    },
    "amount": {
      "type": "number",
      "required": true,
      "description": "Transaction amount"
    },
    "currency": {
      "type": "string",
      "required": true,
      "description": "ISO 4217 currency code"
    },
    "merchant_id": {
      "type": "string",
      "required": true,
      "description": "Merchant identifier"
    },
    "return_url": {
      "type": "string",
      "required": true,
      "description": "URL for authentication redirect"
    },
    "browser_info": {
      "type": "string",
      "required": false,
      "description": "Browser information for 3DS2",
      "default": "None"
    },
    "challenge_preference": {
      "type": "string",
      "required": false,
      "description": "Challenge preference (no_preference, challenge_requested, challenge_mandated)",
      "default": "no_preference"
    }
  },
  "error_messages": [
    "Card not enrolled: The card is not enrolled in 3D Secure program.",
    "Invalid return URL: Provide a valid HTTPS URL for authentication redirect.",
    "3DS service unavailable: 3D Secure authentication service is temporarily unavailable.",
    "Invalid challenge preference: Use one of [no_preference, challenge_requested, challenge_mandated].",
    "Authentication failed: Customer failed to complete 3DS authentication."
  ],
  "usage": "Provide card details, transaction amount, and redirect URL to initiate 3D Secure authentication. Returns authentication URL and transaction tokens.",
  "output_details": {
    "authentication_url": {
      "type": "string",
      "description": "URL for customer authentication"
    },
    "transaction_id": {
      "type": "string",
      "description": "3DS transaction identifier"
    },
    "challenge_required": {
      "type": "boolean",
      "description": "Whether customer challenge is required"
    },
    "protocol_version": {
      "type": "string",
      "description": "3DS protocol version used"
    },
    "authentication_token": {
      "type": "string",
      "description": "Authentication token for transaction completion"
    }
  }
}