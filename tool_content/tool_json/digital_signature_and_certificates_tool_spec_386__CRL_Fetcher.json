{
  "tool_name": "CRL Fetcher",
  "tool_description": "Retrieves and parses Certificate Revocation Lists (CRLs) from specified URLs or from certificate CRL distribution points, with caching and validation capabilities.",
  "parameters": {
    "crl_url": {
      "type": "string",
      "required": false,
      "description": "Direct URL to fetch CRL from",
      "default": "None"
    },
    "certificate": {
      "type": "string",
      "required": false,
      "description": "Certificate containing CRL distribution points to fetch from",
      "default": "None"
    },
    "timeout_seconds": {
      "type": "integer",
      "required": false,
      "description": "HTTP request timeout in seconds (1-300)",
      "default": 30
    },
    "use_cache": {
      "type": "boolean",
      "required": false,
      "description": "Whether to use cached CRL if available and not expired",
      "default": true
    },
    "validate_crl": {
      "type": "boolean",
      "required": false,
      "description": "Whether to validate CRL signature and dates",
      "default": true
    }
  },
  "error_messages": [
    "No CRL source specified: Must provide either crl_url or certificate with CRL distribution points.",
    "CRL fetch failed: Unable to retrieve CRL from specified URL(s) within timeout period.",
    "Invalid CRL format: Retrieved data is not a valid CRL format.",
    "CRL validation failed: CRL signature or validity dates are invalid.",
    "Timeout out of range: Timeout must be between 1 and 300 seconds.",
    "Network error: Unable to establish connection to CRL endpoint."
  ],
  "usage": "Provide either crl_url for direct fetch or certificate with CRL distribution points. Configure timeout, caching, and validation options as needed. Returns CRL data and metadata.",
  "output_details": {
    "crl_data": {
      "type": "string",
      "description": "The retrieved CRL in PEM format"
    },
    "issuer": {
      "type": "string",
      "description": "CRL issuer distinguished name"
    },
    "this_update": {
      "type": "string",
      "description": "CRL issue date",
      "format": "date-time"
    },
    "next_update": {
      "type": "string",
      "description": "Next scheduled CRL update",
      "format": "date-time"
    },
    "revoked_certificates": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "List of revoked certificate serial numbers"
    },
    "crl_number": {
      "type": "integer",
      "description": "CRL sequence number"
    },
    "from_cache": {
      "type": "boolean",
      "description": "Whether CRL was retrieved from cache"
    }
  }
}