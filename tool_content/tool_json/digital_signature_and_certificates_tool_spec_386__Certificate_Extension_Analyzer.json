{
  "tool_name": "Certificate Extension Analyzer",
  "tool_description": "Analyzes and validates X.509 certificate extensions including key usage, extended key usage, basic constraints, subject alternative names, and custom extensions with criticality checking.",
  "parameters": {
    "certificate": {
      "type": "string",
      "required": true,
      "description": "Certificate containing extensions to analyze"
    },
    "required_extensions": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "required": false,
      "description": "List of extension OIDs that must be present",
      "default": "None"
    },
    "forbidden_extensions": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "required": false,
      "description": "List of extension OIDs that must not be present",
      "default": "None"
    },
    "check_criticality": {
      "type": "boolean",
      "required": false,
      "description": "Whether to validate critical extension handling",
      "default": true
    },
    "validate_constraints": {
      "type": "boolean",
      "required": false,
      "description": "Whether to validate basic constraints for CA certificates",
      "default": true
    },
    "analyze_key_usage": {
      "type": "boolean",
      "required": false,
      "description": "Whether to analyze key usage and extended key usage",
      "default": true
    }
  },
  "error_messages": [
    "Invalid certificate: Certificate data cannot be parsed or is malformed.",
    "Required extension missing: One or more required extensions are not present in certificate.",
    "Forbidden extension present: Certificate contains extensions that are not allowed.",
    "Critical extension unrecognized: Certificate contains critical extensions that cannot be processed.",
    "Invalid extension format: One or more extensions have malformed data.",
    "Constraint violation: Certificate violates basic constraints or other extension constraints."
  ],
  "usage": "Provide certificate to analyze. Optionally specify required_extensions, forbidden_extensions, and validation options. Returns detailed extension analysis results.",
  "output_details": {
    "extensions_present": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "List of extension OIDs found in certificate"
    },
    "critical_extensions": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "List of extensions marked as critical"
    },
    "key_usage": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "Key usage flags present in certificate"
    },
    "extended_key_usage": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "Extended key usage purposes"
    },
    "is_ca": {
      "type": "boolean",
      "description": "Whether certificate is marked as a CA certificate"
    },
    "path_length": {
      "type": "integer",
      "description": "Maximum certification path length for CA certificates"
    },
    "subject_alt_names": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "Subject alternative names present"
    },
    "validation_errors": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "List of extension validation errors found"
    }
  }
}