{
  "tool_name": "Discount Application Engine",
  "tool_description": "Applies validated discounts to the shopping cart, updating item prices and calculating final totals with proper discount allocation.",
  "parameters": {
    "validated_discounts": {
      "type": "array",
      "required": true,
      "description": "List of validated discount IDs to apply",
      "items": {
        "type": "string"
      },
      "minItems": 1,
      "maxItems": 10
    },
    "cart_items": {
      "type": "array",
      "required": true,
      "description": "List of product IDs in the cart",
      "items": {
        "type": "string"
      },
      "minItems": 1,
      "maxItems": 100
    },
    "item_prices": {
      "type": "array",
      "required": true,
      "description": "Original prices for each cart item",
      "items": {
        "type": "number"
      },
      "minItems": 1,
      "maxItems": 100
    },
    "item_quantities": {
      "type": "array",
      "required": true,
      "description": "Quantities for each cart item",
      "items": {
        "type": "integer"
      },
      "minItems": 1,
      "maxItems": 100
    },
    "user_id": {
      "type": "string",
      "required": true,
      "description": "Unique identifier of the user"
    },
    "session_id": {
      "type": "string",
      "required": false,
      "description": "Shopping session identifier for tracking",
      "default": null
    },
    "apply_best_combination": {
      "type": "boolean",
      "required": false,
      "description": "Whether to automatically select the best discount combination",
      "default": true
    },
    "preserve_order": {
      "type": "boolean",
      "required": false,
      "description": "Whether to preserve the order of discount application",
      "default": false
    },
    "include_tax_calculation": {
      "type": "boolean",
      "required": false,
      "description": "Whether to include tax calculations in the result",
      "default": true
    },
    "tax_rate": {
      "type": "number",
      "required": false,
      "description": "Tax rate to apply (as decimal)",
      "default": 0.0
    },
    "currency": {
      "type": "string",
      "required": false,
      "description": "Currency code for the transaction",
      "default": "USD"
    }
  },
  "error_messages": [
    "Mismatched array lengths: cart_items, item_prices, and item_quantities must have the same length.",
    "Invalid discount IDs: All validated discount IDs must exist and be currently valid.",
    "Invalid user ID: A valid user identifier must be provided.",
    "Invalid price or quantity values: All prices must be positive numbers and quantities must be positive integers.",
    "Application failed: Unable to apply discounts due to system constraints.",
    "Invalid tax rate: Tax rate must be between 0 and 1.",
    "Currency not supported: The specified currency is not supported."
  ],
  "usage": "Provide validated_discounts, cart_items, item_prices, item_quantities, and user_id to apply discounts. Configure application behavior with optional parameters. Returns updated cart with applied discounts.",
  "output_details": {
    "updated_cart_total": {
      "type": "number",
      "description": "Final cart total after all discounts applied"
    },
    "total_savings": {
      "type": "number",
      "description": "Total amount saved from all applied discounts"
    },
    "applied_discount_details": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "Details of each applied discount"
    },
    "line_item_totals": {
      "type": "array",
      "items": {
        "type": "number"
      },
      "description": "Final price for each line item after discounts"
    },
    "tax_amount": {
      "type": "number",
      "description": "Tax amount calculated on discounted total"
    },
    "final_total_with_tax": {
      "type": "number",
      "description": "Final total including tax"
    },
    "discount_breakdown": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "Breakdown of how each discount was applied"
    }
  }
}