{
  "tool_name": "Database Connection Auditor",
  "tool_description": "Monitors and audits database connections, tracking connection events, patterns, and security-relevant activities.",
  "parameters": {
    "monitoring_scope": {
      "type": "string",
      "required": true,
      "description": "Scope of monitoring: all_connections, user_specific, role_based, suspicious_only"
    },
    "target_user": {
      "type": "string",
      "required": false,
      "description": "Specific user to monitor (required for user_specific scope)",
      "default": null
    },
    "target_role": {
      "type": "string",
      "required": false,
      "description": "Specific role to monitor (required for role_based scope)",
      "default": null
    },
    "start_time": {
      "type": "string",
      "required": true,
      "description": "Start of monitoring period",
      "format": "date-time"
    },
    "end_time": {
      "type": "string",
      "required": true,
      "description": "End of monitoring period",
      "format": "date-time"
    },
    "include_successful": {
      "type": "boolean",
      "required": false,
      "description": "Include successful connection attempts",
      "default": true
    },
    "include_failed": {
      "type": "boolean",
      "required": false,
      "description": "Include failed connection attempts",
      "default": true
    }
  },
  "error_messages": [
    "Invalid monitoring scope: Use one of [all_connections, user_specific, role_based, suspicious_only]",
    "Target required: target_user required for user_specific scope, target_role for role_based scope",
    "User not found: Specified target_user does not exist",
    "Role not found: Specified target_role does not exist",
    "Invalid time range: start_time must be before end_time",
    "Time range too large: Monitoring period cannot exceed 30 days"
  ],
  "usage": "Specify monitoring_scope and time range with start_time and end_time. For targeted monitoring, provide target_user or target_role. Control audit detail with include_successful and include_failed flags.",
  "output_details": {
    "total_connections": {
      "type": "integer",
      "description": "Total number of connection attempts"
    },
    "successful_connections": {
      "type": "integer",
      "description": "Number of successful connections"
    },
    "failed_connections": {
      "type": "integer",
      "description": "Number of failed connections"
    },
    "unique_users": {
      "type": "integer",
      "description": "Number of unique users in the audit period"
    },
    "connection_events": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "Summary of connection events"
    },
    "anomalies_detected": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "List of detected anomalies or suspicious activities"
    }
  }
}