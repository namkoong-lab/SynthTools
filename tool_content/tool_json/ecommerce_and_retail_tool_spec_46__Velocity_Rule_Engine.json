{
  "tool_name": "Velocity Rule Engine",
  "tool_description": "Analyzes transaction velocity patterns to detect suspicious activity based on configurable rules for frequency, amounts, and time windows.",
  "parameters": {
    "card_number": {
      "type": "string",
      "required": true,
      "description": "Masked card number for velocity tracking"
    },
    "transaction_amount": {
      "type": "number",
      "required": true,
      "description": "Current transaction amount"
    },
    "merchant_id": {
      "type": "string",
      "required": true,
      "description": "Merchant account identifier"
    },
    "customer_ip": {
      "type": "string",
      "required": true,
      "description": "Customer IP address"
    },
    "time_window_minutes": {
      "type": "integer",
      "required": false,
      "description": "Time window for velocity analysis (1-1440 minutes)",
      "default": 60
    },
    "max_transactions": {
      "type": "integer",
      "required": false,
      "description": "Maximum allowed transactions in time window",
      "default": 5
    },
    "max_amount": {
      "type": "number",
      "required": false,
      "description": "Maximum allowed total amount in time window",
      "default": 1000.0
    },
    "check_ip_velocity": {
      "type": "boolean",
      "required": false,
      "description": "Whether to check IP-based velocity",
      "default": true
    },
    "check_card_velocity": {
      "type": "boolean",
      "required": false,
      "description": "Whether to check card-based velocity",
      "default": true
    }
  },
  "error_messages": [
    "Invalid time window: Time window must be between 1 and 1440 minutes.",
    "Invalid velocity limits: max_transactions must be positive, max_amount must be greater than 0.",
    "Velocity check failed: Unable to retrieve transaction history for velocity analysis.",
    "Rate limit exceeded: Transaction frequency exceeds configured velocity rules."
  ],
  "usage": "Provide card number, transaction details, and velocity configuration. Returns velocity analysis results with rule violation details.",
  "output_details": {
    "velocity_passed": {
      "type": "boolean",
      "description": "Whether transaction passes all velocity checks"
    },
    "violated_rules": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "List of violated velocity rules"
    },
    "transaction_count": {
      "type": "integer",
      "description": "Number of transactions in time window"
    },
    "total_amount": {
      "type": "number",
      "description": "Total transaction amount in time window"
    },
    "risk_level": {
      "type": "string",
      "description": "Velocity-based risk level (low, medium, high)"
    }
  }
}